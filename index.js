(()=>{var e={271:function(e,t){var r,s,n;s=[],void 0===(n="function"==typeof(r=function(){"use strict";var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,r="boolean"==typeof(new RegExp).sticky;function s(e){return e&&"[object RegExp]"===t.call(e)}function n(e){return e&&"object"==typeof e&&!s(e)&&!Array.isArray(e)}function o(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(e){return new RegExp("|"+e).exec("").length-1}function i(e){return"("+e+")"}function l(e){return e.length?"(?:"+e.map((function(e){return"(?:"+e+")"})).join("|")+")":"(?!)"}function p(e){if("string"==typeof e)return"(?:"+o(e)+")";if(s(e)){if(e.ignoreCase)throw new Error("RegExp /i flag not allowed");if(e.global)throw new Error("RegExp /g flag is implied");if(e.sticky)throw new Error("RegExp /y flag is implied");if(e.multiline)throw new Error("RegExp /m flag is implied");return e.source}throw new Error("Not a pattern: "+e)}function c(e){for(var t=Object.getOwnPropertyNames(e),r=[],s=0;s<t.length;s++){var o=t[s],a=e[o],i=[].concat(a);if("include"!==o){var l=[];i.forEach((function(e){n(e)?(l.length&&r.push(h(o,l)),r.push(h(o,e)),l=[]):l.push(e)})),l.length&&r.push(h(o,l))}else for(var p=0;p<i.length;p++)r.push({include:i[p]})}return r}function u(e){for(var t=[],r=0;r<e.length;r++){var s=e[r];if(s.include)for(var n=[].concat(s.include),o=0;o<n.length;o++)t.push({include:n[o]});else{if(!s.type)throw new Error("Rule has no type: "+JSON.stringify(s));t.push(h(s.type,s))}}return t}function h(t,r){if(n(r)||(r={match:r}),r.include)throw new Error("Matching rules cannot also include states");var o={defaultType:t,lineBreaks:!!r.error||!!r.fallback,pop:!1,next:null,push:null,error:!1,fallback:!1,value:null,type:null,shouldThrow:!1};for(var a in r)e.call(r,a)&&(o[a]=r[a]);if("string"==typeof o.type&&t!==o.type)throw new Error("Type transform cannot be a string (type '"+o.type+"' for token '"+t+"')");var i=o.match;return o.match=Array.isArray(i)?i:i?[i]:[],o.match.sort((function(e,t){return s(e)&&s(t)?0:s(t)?-1:s(e)?1:t.length-e.length})),o}function f(e){return Array.isArray(e)?u(e):c(e)}var m=h("error",{lineBreaks:!0,shouldThrow:!0});function y(e,t){for(var n=null,o=Object.create(null),c=!0,u=null,h=[],f=[],y=0;y<e.length;y++)e[y].fallback&&(c=!1);for(y=0;y<e.length;y++){var b=e[y];if(b.include)throw new Error("Inheritance is not allowed in stateless lexers");if(b.error||b.fallback){if(n)throw!b.fallback==!n.fallback?new Error("Multiple "+(b.fallback?"fallback":"error")+" rules not allowed (for token '"+b.defaultType+"')"):new Error("fallback and error are mutually exclusive (for token '"+b.defaultType+"')");n=b}var d=b.match.slice();if(c)for(;d.length&&"string"==typeof d[0]&&1===d[0].length;)o[d.shift().charCodeAt(0)]=b;if(b.pop||b.push||b.next){if(!t)throw new Error("State-switching options are not allowed in stateless lexers (for token '"+b.defaultType+"')");if(b.fallback)throw new Error("State-switching options are not allowed on fallback tokens (for token '"+b.defaultType+"')")}if(0!==d.length){c=!1,h.push(b);for(var g=0;g<d.length;g++){var x=d[g];if(s(x))if(null===u)u=x.unicode;else if(u!==x.unicode&&!1===b.fallback)throw new Error("If one rule is /u then all must be")}var v=l(d.map(p)),w=new RegExp(v);if(w.test(""))throw new Error("RegExp matches empty string: "+w);if(a(v)>0)throw new Error("RegExp has capture groups: "+w+"\nUse (?: … ) instead");if(!b.lineBreaks&&w.test("\n"))throw new Error("Rule should declare lineBreaks: "+w);f.push(i(v))}}var $=n&&n.fallback,k=r&&!$?"ym":"gm",E=r||$?"":"|";return!0===u&&(k+="u"),{regexp:new RegExp(l(f)+E,k),groups:h,fast:o,error:n||m}}function b(e){var t=y(f(e));return new v({start:t},"start")}function d(e,t,r){var s=e&&(e.push||e.next);if(s&&!r[s])throw new Error("Missing state '"+s+"' (in token '"+e.defaultType+"' of state '"+t+"')");if(e&&e.pop&&1!=+e.pop)throw new Error("pop must be 1 (in token '"+e.defaultType+"' of state '"+t+"')")}function g(e,t){var r=e.$all?f(e.$all):[];delete e.$all;var s=Object.getOwnPropertyNames(e);t||(t=s[0]);for(var n=Object.create(null),o=0;o<s.length;o++)n[g=s[o]]=f(e[g]).concat(r);for(o=0;o<s.length;o++)for(var a=n[g=s[o]],i=Object.create(null),l=0;l<a.length;l++){var p=a[l];if(p.include){var c=[l,1];if(p.include!==g&&!i[p.include]){i[p.include]=!0;var u=n[p.include];if(!u)throw new Error("Cannot include nonexistent state '"+p.include+"' (in state '"+g+"')");for(var h=0;h<u.length;h++){var m=u[h];-1===a.indexOf(m)&&c.push(m)}}a.splice.apply(a,c),l--}}var b=Object.create(null);for(o=0;o<s.length;o++){var g;b[g=s[o]]=y(n[g],!0)}for(o=0;o<s.length;o++){var x=s[o],w=b[x],$=w.groups;for(l=0;l<$.length;l++)d($[l],x,b);var k=Object.getOwnPropertyNames(w.fast);for(l=0;l<k.length;l++)d(w.fast[k[l]],x,b)}return new v(b,t)}function x(e){for(var t=Object.create(null),r=Object.create(null),s=Object.getOwnPropertyNames(e),n=0;n<s.length;n++){var o=s[n],a=e[o];(Array.isArray(a)?a:[a]).forEach((function(e){if((r[e.length]=r[e.length]||[]).push(e),"string"!=typeof e)throw new Error("keyword must be string (in keyword '"+o+"')");t[e]=o}))}function i(e){return JSON.stringify(e)}var l="";for(var p in l+="switch (value.length) {\n",r){var c=r[p];l+="case "+p+":\n",l+="switch (value) {\n",c.forEach((function(e){var r=t[e];l+="case "+i(e)+": return "+i(r)+"\n"})),l+="}\n"}return l+="}\n",Function("value",l)}var v=function(e,t){this.startState=t,this.states=e,this.buffer="",this.stack=[],this.reset()};v.prototype.reset=function(e,t){return this.buffer=e||"",this.index=0,this.line=t?t.line:1,this.col=t?t.col:1,this.queuedToken=t?t.queuedToken:null,this.queuedThrow=t?t.queuedThrow:null,this.setState(t?t.state:this.startState),this.stack=t&&t.stack?t.stack.slice():[],this},v.prototype.save=function(){return{line:this.line,col:this.col,state:this.state,stack:this.stack.slice(),queuedToken:this.queuedToken,queuedThrow:this.queuedThrow}},v.prototype.setState=function(e){if(e&&this.state!==e){this.state=e;var t=this.states[e];this.groups=t.groups,this.error=t.error,this.re=t.regexp,this.fast=t.fast}},v.prototype.popState=function(){this.setState(this.stack.pop())},v.prototype.pushState=function(e){this.stack.push(this.state),this.setState(e)};var w=r?function(e,t){return e.exec(t)}:function(e,t){var r=e.exec(t);return 0===r[0].length?null:r};function $(){return this.value}if(v.prototype._getGroup=function(e){for(var t=this.groups.length,r=0;r<t;r++)if(void 0!==e[r+1])return this.groups[r];throw new Error("Cannot find token type for matched text")},v.prototype.next=function(){var e=this.index;if(this.queuedGroup){var t=this._token(this.queuedGroup,this.queuedText,e);return this.queuedGroup=null,this.queuedText="",t}var r=this.buffer;if(e!==r.length){if(a=this.fast[r.charCodeAt(e)])return this._token(a,r.charAt(e),e);var s=this.re;s.lastIndex=e;var n=w(s,r),o=this.error;if(null==n)return this._token(o,r.slice(e,r.length),e);var a=this._getGroup(n),i=n[0];return o.fallback&&n.index!==e?(this.queuedGroup=a,this.queuedText=i,this._token(o,r.slice(e,n.index),e)):this._token(a,i,e)}},v.prototype._token=function(e,t,r){var s=0;if(e.lineBreaks){var n=/\n/g,o=1;if("\n"===t)s=1;else for(;n.exec(t);)s++,o=n.lastIndex}var a={type:"function"==typeof e.type&&e.type(t)||e.defaultType,value:"function"==typeof e.value?e.value(t):t,text:t,toString:$,offset:r,lineBreaks:s,line:this.line,col:this.col},i=t.length;if(this.index+=i,this.line+=s,0!==s?this.col=i-o+1:this.col+=i,e.shouldThrow)throw new Error(this.formatError(a,"invalid syntax"));return e.pop?this.popState():e.push?this.pushState(e.push):e.next&&this.setState(e.next),a},"undefined"!=typeof Symbol&&Symbol.iterator){var k=function(e){this.lexer=e};k.prototype.next=function(){var e=this.lexer.next();return{value:e,done:!e}},k.prototype[Symbol.iterator]=function(){return this},v.prototype[Symbol.iterator]=function(){return new k(this)}}return v.prototype.formatError=function(e,t){if(null==e){var r=this.buffer.slice(this.index);e={text:r,offset:this.index,lineBreaks:-1===r.indexOf("\n")?0:1,line:this.line,col:this.col}}var s=Math.max(0,e.offset-e.col+1),n=e.lineBreaks?e.text.indexOf("\n"):e.text.length,o=this.buffer.substring(s,e.offset+n);return t+=" at line "+e.line+" col "+e.col+":\n\n",t+="  "+o+"\n",t+="  "+Array(e.col).join(" ")+"^"},v.prototype.clone=function(){return new v(this.states,this.state)},v.prototype.has=function(e){return!0},{compile:b,states:g,error:Object.freeze({error:!0}),fallback:Object.freeze({fallback:!0}),keywords:x}})?r.apply(t,s):r)||(e.exports=n)},783:(e,t,r)=>{!function(){function t(e){return e[0]}const s=r(271).compile({_:/\\? /,number:/(?:\d|\\? )+(?:\.(?!\.\.)(?:\d|\\? )*)?|\.(?:\d|\\? )+/,trig:/\\(?:arc?)?(?:sin|cos|tan|csc|sec|cot)h?(?![A-Za-z])|\\operatorname{(?:arc?)?(?:sin|cos|tan|csc|sec|cot)h?}/,op0:/=|[<>]=?|~|\\(?:[lg]eq?|sim)(?![A-Za-z])/,op1:/[+-]/,op2:/[*/]|\\(?:times|div|cdot)(?![A-Za-z])/,operator:/\\operatorname(?!{ans}){[A-Za-z]+}/,reserved:/\\(?:frac|sqrt|log|ln|left|right|int|sum|prod)(?![A-Za-z])/,percent:/\\%\\operatorname{of}/,defined:/\\operatorname{ans}|\\(?:[A-Za-z]+|{|})|[A-Za-z]/,ellipsis:/\.{3}/,other:/./});var n;s.next=(n=s.next,()=>{let e;for(;(e=n.call(s))&&"_"===e.type;);return e});const o=(...e)=>t=>e.map((e=>"number"==typeof e?t[e]:e)),a=o(1,0,2),i=(...e)=>o("skip",...e);var l={Lexer:s,ParserRules:[{name:"stmt",symbols:["expr"]},{name:"stmt",symbols:["stmtsingle"]},{name:"stmt",symbols:["stmtdouble"]},{name:"stmtsingle",symbols:["expr",s.has("op0")?{type:"op0"}:op0,"expr"],postprocess:a},{name:"stmtdouble",symbols:["expr",s.has("op0")?{type:"op0"}:op0,"stmtsingle"],postprocess:a},{name:"expr",symbols:["term"]},{name:"expr",symbols:["expr",s.has("op1")?{type:"op1"}:op1,"term"],postprocess:a},{name:"term$ebnf$1",symbols:[s.has("op1")?{type:"op1"}:op1],postprocess:t},{name:"term$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"term",symbols:["term$ebnf$1","factor"]},{name:"term$subexpression$1$ebnf$1",symbols:[s.has("op1")?{type:"op1"}:op1],postprocess:t},{name:"term$subexpression$1$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"term$subexpression$1",symbols:["term$subexpression$1$ebnf$1","term"]},{name:"term$subexpression$2$ebnf$1",symbols:[s.has("op1")?{type:"op1"}:op1],postprocess:t},{name:"term$subexpression$2$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"term$subexpression$2",symbols:["term$subexpression$2$ebnf$1","factor"]},{name:"term",symbols:["term$subexpression$1",s.has("op2")?{type:"op2"}:op2,"term$subexpression$2"],postprocess:a},{name:"term",symbols:["term","factor"],postprocess:o("*",0,1)},{name:"factor",symbols:[s.has("number")?{type:"number"}:number]},{name:"factor",symbols:["method"]},{name:"factor",symbols:["trigmethod"]},{name:"factor",symbols:["bracket"]},{name:"factor",symbols:["bracketpara"]},{name:"factor",symbols:["abs"]},{name:"factor",symbols:["factor","sup"],postprocess:o("^",0,1)},{name:"factor",symbols:["frac"]},{name:"factor",symbols:["sqrt"]},{name:"factor",symbols:["log"]},{name:"factor",symbols:["integral"]},{name:"factor",symbols:["accum"]},{name:"factor",symbols:["factorial"]},{name:"factor",symbols:["percent"]},{name:"factor",symbols:["list"]},{name:"factor",symbols:["piecewise"]},{name:"char",symbols:[/[A-Za-z0-9]/]},{name:"chars$ebnf$1",symbols:["char"]},{name:"chars$ebnf$1",symbols:["chars$ebnf$1","char"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"chars",symbols:["chars$ebnf$1"]},{name:"varsub",symbols:["char"]},{name:"varsub",symbols:[{literal:"{"},"chars",{literal:"}"}],postprocess:i(1)},{name:"var",symbols:[s.has("defined")?{type:"defined"}:defined]},{name:"var",symbols:[s.has("defined")?{type:"defined"}:defined,{literal:"_"},"varsub"],postprocess:o("var",0,2)},{name:"para",symbols:[s.has("defined")?{type:"defined"}:defined]},{name:"para",symbols:["char"]},{name:"para",symbols:["bracketpara"]},{name:"sup",symbols:[{literal:"^"},"para"],postprocess:i(1)},{name:"sub",symbols:[{literal:"_"},"para"],postprocess:i(1)},{name:"frac",symbols:[{literal:"\\frac"},"para","para"]},{name:"sqrt",symbols:[{literal:"\\sqrt"},"para"],postprocess:o("√","2",1)},{name:"sqrt",symbols:[{literal:"\\sqrt"},{literal:"["},"expr",{literal:"]"},"para"],postprocess:o("√",2,4)},{name:"log",symbols:[{literal:"\\log"},"callsingle"],postprocess:o("\\log","10",1)},{name:"log",symbols:[{literal:"\\log"},"sub","callsingle"]},{name:"log",symbols:[{literal:"\\ln"},"callsingle"],postprocess:o("\\log","e",1)},{name:"arctan$ebnf$1",symbols:["sup"],postprocess:t},{name:"arctan$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"arctan",symbols:[{literal:"\\arctan"},"arctan$ebnf$1","duple"],postprocess:o("atan2",1,2)},{name:"arctan",symbols:[{literal:"\\tan"},{literal:"^"},{literal:"{"},{literal:"-"},{literal:"1"},{literal:"}"},"duple"],postprocess:o("atan2",6)},{name:"trigmethod",symbols:["arctan"]},{name:"trigmethod$ebnf$1",symbols:["sup"],postprocess:t},{name:"trigmethod$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"trigmethod",symbols:[s.has("trig")?{type:"trig"}:trig,"trigmethod$ebnf$1","callsingle"]},{name:"function",symbols:[s.has("operator")?{type:"operator"}:operator]},{name:"function",symbols:["var"]},{name:"method$ebnf$1",symbols:["call"],postprocess:t},{name:"method$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"method",symbols:["function","method$ebnf$1"]},{name:"abs",symbols:[{literal:"\\left"},{literal:"|"},"expr",{literal:"\\right"},{literal:"|"}],postprocess:o("abs",2)},{name:"args",symbols:["expr"]},{name:"args",symbols:["argsmany"]},{name:"argsmany",symbols:["args",{literal:","},"expr"],postprocess:i(0,2)},{name:"bracket",symbols:[{literal:"("},"expr",{literal:")"}],postprocess:o("bracket",1)},{name:"bracket",symbols:[{literal:"\\left"},{literal:"("},"expr",{literal:"\\right"},{literal:")"}],postprocess:o("bracket",2)},{name:"bracketpara",symbols:[{literal:"{"},"expr",{literal:"}"}],postprocess:i(1)},{name:"call",symbols:[{literal:"("},"argsmany",{literal:")"}],postprocess:i(1)},{name:"call",symbols:[{literal:"\\left"},{literal:"("},"argsmany",{literal:"\\right"},{literal:")"}],postprocess:i(2)},{name:"callsingle",symbols:["bracket"]},{name:"callsingle",symbols:["expr"]},{name:"duple",symbols:[{literal:"("},"expr",{literal:","},"expr",{literal:")"}],postprocess:i(1,3)},{name:"duple",symbols:[{literal:"\\left"},{literal:"("},"expr",{literal:","},"expr",{literal:"\\right"},{literal:")"}],postprocess:i(2,4)},{name:"integral",symbols:[{literal:"\\int"},"sub","sup","term",{literal:"d"},"var"],postprocess:o("integral",5,1,2,3)},{name:"accum$subexpression$1",symbols:[{literal:"\\sum"}]},{name:"accum$subexpression$1",symbols:[{literal:"\\prod"}]},{name:"accum",symbols:["accum$subexpression$1",{literal:"_"},{literal:"{"},"var",{literal:"="},"expr",{literal:"}"},"sup","term"],postprocess:o(0,3,5,7,8)},{name:"factorial",symbols:["term",{literal:"!"}],postprocess:o("factorial",0)},{name:"percent",symbols:["term",s.has("percent")?{type:"percent"}:percent,"term"],postprocess:o("percent",0,2)},{name:"list$ebnf$1",symbols:["listargs"],postprocess:t},{name:"list$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"list",symbols:[{literal:"["},"list$ebnf$1",{literal:"]"}],postprocess:o("list",1)},{name:"list$ebnf$2",symbols:["listargs"],postprocess:t},{name:"list$ebnf$2",symbols:[],postprocess:function(e){return null}},{name:"list",symbols:[{literal:"\\left"},{literal:"["},"list$ebnf$2",{literal:"\\right"},{literal:"]"}],postprocess:o("list",2)},{name:"listargs",symbols:["args"]},{name:"listargs$ebnf$1",symbols:[{literal:","}],postprocess:t},{name:"listargs$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"listargs$ebnf$2",symbols:[{literal:","}],postprocess:t},{name:"listargs$ebnf$2",symbols:[],postprocess:function(e){return null}},{name:"listargs",symbols:["args","listargs$ebnf$1",s.has("ellipsis")?{type:"ellipsis"}:ellipsis,"listargs$ebnf$2","args"],postprocess:i(0,2,4)},{name:"piecewisearg",symbols:["stmt"],postprocess:o("condition",0)},{name:"piecewisearg",symbols:["stmt",{literal:":"},"expr"],postprocess:o("condition",0,2)},{name:"piecewiseargs",symbols:["piecewisearg"]},{name:"piecewiseargs",symbols:["piecewiseargs",{literal:","},"piecewisearg"],postprocess:i(0,2)},{name:"otherwise",symbols:[{literal:","},"expr"],postprocess:o("condition",1)},{name:"conditions$ebnf$1",symbols:["otherwise"],postprocess:t},{name:"conditions$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"conditions",symbols:["piecewiseargs","conditions$ebnf$1"],postprocess:i(0,1)},{name:"piecewise$ebnf$1",symbols:["conditions"],postprocess:t},{name:"piecewise$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"piecewise",symbols:[{literal:"\\{"},"piecewise$ebnf$1",{literal:"\\}"}],postprocess:o("piecewise",1)},{name:"piecewise$ebnf$2",symbols:["conditions"],postprocess:t},{name:"piecewise$ebnf$2",symbols:[],postprocess:function(e){return null}},{name:"piecewise",symbols:[{literal:"\\left"},{literal:"\\{"},"piecewise$ebnf$2",{literal:"\\right"},{literal:"\\}"}],postprocess:o("piecewise",2)}],ParserStart:"stmt"};void 0!==e.exports?e.exports=l:window.grammar=l}()},654:function(e){var t,r;t=this,r=function(){function e(t,r,s){return this.id=++e.highestId,this.name=t,this.symbols=r,this.postprocess=s,this}function t(e,t,r,s){this.rule=e,this.dot=t,this.reference=r,this.data=[],this.wantedBy=s,this.isComplete=this.dot===e.symbols.length}function r(e,t){this.grammar=e,this.index=t,this.states=[],this.wants={},this.scannable=[],this.completed={}}function s(e,t){this.rules=e,this.start=t||this.rules[0].name;var r=this.byName={};this.rules.forEach((function(e){r.hasOwnProperty(e.name)||(r[e.name]=[]),r[e.name].push(e)}))}function n(){this.reset("")}function o(e,t,o){if(e instanceof s){var a=e;o=t}else a=s.fromCompiled(e,t);for(var i in this.grammar=a,this.options={keepHistory:!1,lexer:a.lexer||new n},o||{})this.options[i]=o[i];this.lexer=this.options.lexer,this.lexerState=void 0;var l=new r(a,0);this.table=[l],l.wants[a.start]=[],l.predict(a.start),l.process(),this.current=0}function a(e){var t=typeof e;if("string"===t)return e;if("object"===t){if(e.literal)return JSON.stringify(e.literal);if(e instanceof RegExp)return e.toString();if(e.type)return"%"+e.type;if(e.test)return"<"+String(e.test)+">";throw new Error("Unknown symbol type: "+e)}}return e.highestId=0,e.prototype.toString=function(e){var t=void 0===e?this.symbols.map(a).join(" "):this.symbols.slice(0,e).map(a).join(" ")+" ● "+this.symbols.slice(e).map(a).join(" ");return this.name+" → "+t},t.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},t.prototype.nextState=function(e){var r=new t(this.rule,this.dot+1,this.reference,this.wantedBy);return r.left=this,r.right=e,r.isComplete&&(r.data=r.build(),r.right=void 0),r},t.prototype.build=function(){var e=[],t=this;do{e.push(t.right.data),t=t.left}while(t.left);return e.reverse(),e},t.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,o.fail))},r.prototype.process=function(e){for(var t=this.states,r=this.wants,s=this.completed,n=0;n<t.length;n++){var a=t[n];if(a.isComplete){if(a.finish(),a.data!==o.fail){for(var i=a.wantedBy,l=i.length;l--;){var p=i[l];this.complete(p,a)}if(a.reference===this.index){var c=a.rule.name;(this.completed[c]=this.completed[c]||[]).push(a)}}}else{if("string"!=typeof(c=a.rule.symbols[a.dot])){this.scannable.push(a);continue}if(r[c]){if(r[c].push(a),s.hasOwnProperty(c)){var u=s[c];for(l=0;l<u.length;l++){var h=u[l];this.complete(a,h)}}}else r[c]=[a],this.predict(c)}}},r.prototype.predict=function(e){for(var r=this.grammar.byName[e]||[],s=0;s<r.length;s++){var n=r[s],o=this.wants[e],a=new t(n,0,this.index,o);this.states.push(a)}},r.prototype.complete=function(e,t){var r=e.nextState(t);this.states.push(r)},s.fromCompiled=function(t,r){var n=t.Lexer;t.ParserStart&&(r=t.ParserStart,t=t.ParserRules);var o=new s(t=t.map((function(t){return new e(t.name,t.symbols,t.postprocess)})),r);return o.lexer=n,o},n.prototype.reset=function(e,t){this.buffer=e,this.index=0,this.line=t?t.line:1,this.lastLineBreak=t?-t.col:0},n.prototype.next=function(){if(this.index<this.buffer.length){var e=this.buffer[this.index++];return"\n"===e&&(this.line+=1,this.lastLineBreak=this.index),{value:e}}},n.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},n.prototype.formatError=function(e,t){var r=this.buffer;if("string"==typeof r){var s=r.split("\n").slice(Math.max(0,this.line-5),this.line),n=r.indexOf("\n",this.index);-1===n&&(n=r.length);var o=this.index-this.lastLineBreak,a=String(this.line).length;return t+=" at line "+this.line+" col "+o+":\n\n",t+=s.map((function(e,t){return i(this.line-s.length+t+1,a)+" "+e}),this).join("\n"),t+="\n"+i("",a+o)+"^\n"}return t+" at index "+(this.index-1);function i(e,t){var r=String(e);return Array(t-r.length+1).join(" ")+r}},o.fail={},o.prototype.feed=function(e){var t,s=this.lexer;for(s.reset(e,this.lexerState);;){try{if(!(t=s.next()))break}catch(e){var o=new r(this.grammar,this.current+1);throw this.table.push(o),(l=new Error(this.reportLexerError(e))).offset=this.current,l.token=e.token,l}var a=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var i=this.current+1;o=new r(this.grammar,i),this.table.push(o);for(var l,p=void 0!==t.text?t.text:t.value,c=s.constructor===n?t.value:t,u=a.scannable,h=u.length;h--;){var f=u[h],m=f.rule.symbols[f.dot];if(m.test?m.test(c):m.type?m.type===t.type:m.literal===p){var y=f.nextState({data:c,token:t,isToken:!0,reference:i-1});o.states.push(y)}}if(o.process(),0===o.states.length)throw(l=new Error(this.reportError(t))).offset=this.current,l.token=t,l;this.options.keepHistory&&(a.lexerState=s.save()),this.current++}return a&&(this.lexerState=s.save()),this.results=this.finish(),this},o.prototype.reportLexerError=function(e){var t,r,s=e.token;return s?(t="input "+JSON.stringify(s.text[0])+" (lexer error)",r=this.lexer.formatError(s,"Syntax error")):(t="input (lexer error)",r=e.message),this.reportErrorCommon(r,t)},o.prototype.reportError=function(e){var t=(e.type?e.type+" token: ":"")+JSON.stringify(void 0!==e.value?e.value:e),r=this.lexer.formatError(e,"Syntax error");return this.reportErrorCommon(r,t)},o.prototype.reportErrorCommon=function(e,t){var r=[];r.push(e);var s=this.table.length-2,n=this.table[s],o=n.states.filter((function(e){var t=e.rule.symbols[e.dot];return t&&"string"!=typeof t}));return 0===o.length?(r.push("Unexpected "+t+". I did not expect any more input. Here is the state of my parse table:\n"),this.displayStateStack(n.states,r)):(r.push("Unexpected "+t+". Instead, I was expecting to see one of the following:\n"),o.map((function(e){return this.buildFirstStateStack(e,[])||[e]}),this).forEach((function(e){var t=e[0],s=t.rule.symbols[t.dot],n=this.getSymbolDisplay(s);r.push("A "+n+" based on:"),this.displayStateStack(e,r)}),this)),r.push(""),r.join("\n")},o.prototype.displayStateStack=function(e,t){for(var r,s=0,n=0;n<e.length;n++){var o=e[n],a=o.rule.toString(o.dot);a===r?s++:(s>0&&t.push("    ^ "+s+" more lines identical to this"),s=0,t.push("    "+a)),r=a}},o.prototype.getSymbolDisplay=function(e){return function(e){var t=typeof e;if("string"===t)return e;if("object"===t){if(e.literal)return JSON.stringify(e.literal);if(e instanceof RegExp)return"character matching "+e;if(e.type)return e.type+" token";if(e.test)return"token matching "+String(e.test);throw new Error("Unknown symbol type: "+e)}}(e)},o.prototype.buildFirstStateStack=function(e,t){if(-1!==t.indexOf(e))return null;if(0===e.wantedBy.length)return[e];var r=e.wantedBy[0],s=[e].concat(t),n=this.buildFirstStateStack(r,s);return null===n?null:[e].concat(n)},o.prototype.save=function(){var e=this.table[this.current];return e.lexerState=this.lexerState,e},o.prototype.restore=function(e){var t=e.index;this.current=t,this.table[t]=e,this.table.splice(t+1),this.lexerState=e.lexerState,this.results=this.finish()},o.prototype.rewind=function(e){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[e])},o.prototype.finish=function(){var e=[],t=this.grammar.start;return this.table[this.table.length-1].states.forEach((function(r){r.rule.name===t&&r.dot===r.rule.symbols.length&&0===r.reference&&r.data!==o.fail&&e.push(r)})),e.map((function(e){return e.data}))},{Parser:o,Grammar:s,Rule:e}},e.exports?e.exports=r():t.nearley=r()}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(654),t=r(783),s=r.n(t);const n=Desmos;const o=r.n(n)().GraphingCalculator(document.getElementById("calculator"));o.setExpression({latex:"x^{2}+y^{2}=10"});const a={times:"×",div:"÷",frac:"/",cdot:"·",le:"≤",ge:"≥",sim:"~",infty:"∞",Alpha:"𝛢",Beta:"𝛣",Gamma:"𝛤",Delta:"𝛥",Epsilon:"𝛦",Zeta:"𝛧",Eta:"𝛨",Theta:"𝛩",Iota:"𝛪",Kappa:"𝛫",Lambda:"𝛬",Mu:"𝛭",Nu:"𝛮",Xi:"𝛯",Omicron:"𝛰",Pi:"𝛱",Rho:"𝛲",Sigma:"𝛴",Tau:"𝛵",Upsilon:"𝛶",Phi:"𝛷",Chi:"𝛸",Psi:"𝛹",Omega:"𝛺",alpha:"𝛼",beta:"𝛽",gamma:"𝛾",delta:"𝛿",epsilon:"𝜀",zeta:"𝜁",eta:"𝜂",theta:"𝜃",iota:"𝜄",kappa:"𝜅",lambda:"𝜆",mu:"𝜇",nu:"𝜈",xi:"𝜉",omicron:"𝜊",pi:"𝜋",rho:"𝜌",sigma:"𝜎",tau:"𝜏",upsilon:"𝜐",phi:"𝜙",chi:"𝜒",psi:"𝜓",omega:"𝜔",sgn:"sign",gcf:"gcd"},i=e=>{let t=e.text||e;if("string"!=typeof t)return e.map(i).join("");if("number"===e.type)return t.replace(/\\? |\.$/g,"").replace(/^\./,"0.");t.startsWith("\\")&&(t=t.slice(1));const r=t.match(/^operatorname{([A-Za-z]+)}$/);return r&&(t=r[1]),"trig"===e.type&&(t=t.replace(/^(arc?)?(...h?)(\^-1)?$/,((e,t,r,s)=>(!t==!s?"":"a")+r))),a[t]||t},l=e=>e?e.type||"string"==typeof e?[e]:e.length?1===(e=e.flatMap(l)).length?[e[0]].flatMap(l):[e]:[]:[],p=e=>e&&!e.type&&"string"!=typeof e&&"skip"===(e=e.flatMap(p))[0]?e.slice(1):[e],c=e=>e.type||"string"==typeof e?e:"bracket"===e[0]?c(e[1]):"trig"===e[0].type&&e.length===("atan2"===e.text)+3?"-"===e[1][0].text&&"1"===e[1][1]?(e[0].text+="^-1",e.splice(1,1),e.map(c)):["^",c(e.splice(1,1)[0]),e.map(c)]:("*"!==e[0]||3!==e.length||"var"!==e[1]&&"operator"!==e[1].type&&"defined"!==e[1].type||"x"===e[1].text||"y"===e[1].text||"bracket"!==e[2][0]||e.splice(0,1),e.map(c)),u=document.getElementById("output"),h=document.getElementById("tree");o.observeEvent("change",(function(){let t=0;try{const{results:r}=new e.Parser(e.Grammar.fromCompiled(s())).feed(o.getExpressions().find((e=>e.latex)).latex);h.textContent="";const n=document.createElement("ul");n.appendChild(function e(r){t++;const s=document.createElement("li"),n=document.createElement("div");if(s.appendChild(n),r.type||"string"==typeof r)return n.textContent=i(r),s;if("var"===r[0]){n.appendChild(document.createTextNode(i(r[1])));const e=document.createElement("sub");return e.textContent=i(r[2]),n.appendChild(e),s}n.textContent=i(r[0]);let o=document.createElement("ul");return s.appendChild(o),r.forEach(((t,r)=>r&&o.appendChild(e(t)))),s}(c(["skip",[r[0]].flatMap(l)[0]].flatMap(p)[1]))),h.appendChild(n),u.textContent=t}catch(e){h.textContent="",u.textContent="?"}}))})()})();